(function(e){function t(t){for(var s,a,o=t[0],l=t[1],c=t[2],h=0,d=[];h<o.length;h++)a=o[h],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);u&&u(t);while(d.length)d.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],s=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(s=!1)}s&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var s={},i={app:0},r=[];function a(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=s,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/deep-dance-visualizer/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"1e42":function(e,t){e.exports={functional:!0,render(e,t){const{_c:n,_v:s,data:i,children:r=[]}=t,{class:a,staticClass:o,style:l,staticStyle:c,attrs:u={},...h}=i;return n("svg",{class:[a,o],style:[l,c],attrs:Object.assign({width:"26",height:"26",fill:"none",xmlns:"http://www.w3.org/2000/svg"},u),...h},r.concat([n("g",{attrs:{"clip-path":"url(#clip0)"}},[n("path",{attrs:{d:"M21.5 10.402c2 1.155 2 4.041 0 5.196L11 21.66c-2 1.155-4.5-.288-4.5-2.598V6.938C6.5 4.628 9 3.185 11 4.34l10.5 6.062z",fill:"#d5d5d5"}})]),n("defs",[n("clipPath",{attrs:{id:"clip0"}},[n("path",{attrs:{fill:"#d5d5d5",d:"M0 0h26v26H0z"}})])])]))}}},"22db":function(e,t,n){"use strict";n("9561")},"41f3":function(e,t,n){"use strict";n("f884")},"4b80":function(e,t){e.exports={functional:!0,render(e,t){const{_c:n,_v:s,data:i,children:r=[]}=t,{class:a,staticClass:o,style:l,staticStyle:c,attrs:u={},...h}=i;return n("svg",{class:[a,o],style:[l,c],attrs:Object.assign({width:"26",height:"26",fill:"none",xmlns:"http://www.w3.org/2000/svg"},u),...h},r.concat([n("rect",{attrs:{x:"5",y:"3",width:"6.563",height:"19",rx:"2",fill:"#d5d5d5"}}),n("rect",{attrs:{x:"13.438",y:"3",width:"6.563",height:"19",rx:"2",fill:"#d5d5d5"}})]))}}},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("DanceScene"),this.$store.state.isPublicMode?n("ControlBar"):e._e(),this.$store.state.isPublicMode?e._e():n("div",{staticClass:"content"},[n("ControlBar"),this.$store.state.isPublicMode?e._e():n("Upload",{attrs:{dataKey:"red"}}),this.$store.state.isPublicMode?e._e():n("Upload",{attrs:{dataKey:"green"}}),this.$store.state.isPublicMode?e._e():n("Upload",{attrs:{dataKey:"blue"}})],1)],1)},r=[],a=n("bc3a"),o=n.n(a),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"scene"}})},c=[],u=(n("b64b"),n("5a89")),h=n("4721"),d=(n("4160"),n("07ac"),n("159b"),n("d4ec")),f=n("bee2"),m=n("547e"),p=function(){function e(t,n,s,i){Object(d["a"])(this,e),this.store=t,this.group=new u["Group"],this.group.position.set(s.x,s.y,s.z),this.key=i,this.lineMaterial=new u["LineBasicMaterial"]({color:n,linewidth:10,linecap:"round",linejoin:"round"}),this.meshLineMaterial=new m["MeshLineMaterial"]({color:n,sizeAttenuation:!0,lineWidth:.03})}return Object(f["a"])(e,[{key:"CreateLines",value:function(e){var t=this;if(null!=this.store.state.currentJSONData[this.key]&&null!=this.store.state.currentJSONData[this.key].frames[e]){var n=this.store.state.currentJSONData[this.key].frames[e],s=0;this.store.state.addMinVal&&n.forEach((function(e){e[2]<s&&(s=e[2])})),this.bonesShadow=[],this.bones=[],Object.values(this.store.state.currentJSONData[this.key].bones).forEach((function(e,i){t.bones[i]=[],t.bonesShadow[i]=[],e.forEach((function(e){t.bonesShadow[i].push(new u["Vector3"](-1*n[e][0],n[e][2]-s,n[e][1]))})),e.forEach((function(e){t.bones[i].push(-1*n[e][0],n[e][2]-s,n[e][1])}));var r=(new u["BufferGeometry"]).setFromPoints(t.bonesShadow[i]),a=new u["Line"](r,t.lineMaterial);a.geometry.verticesNeedUpdate=!0,a.castShadow=!0,a.receiveShadow=!0;var o=new m["MeshLine"];o.setPoints(t.bones[i]);var l=new u["Mesh"](o,t.meshLineMaterial);t.group.add(l,a)}))}}},{key:"RemoveAllLines",value:function(){for(var e=this.group.children.length-1;e>=0;e--)this.group.remove(this.group.children[e])}},{key:"GetGroup",value:function(){return this.group}}]),e}(),g=p,v={name:"DanceScene",props:{msg:String},data:function(){return{mouseX:0,mouseY:0,mouseDown:!1,clock:null,delta:0,interval:.04,linesFigRed:null,linesFigGreen:null,linesFigBlue:null}},methods:{setMouseState:function(e){this.mouseDown=e},initScene:function(){this.clock=new u["Clock"],this.container=document.getElementById("scene"),this.camera=new u["PerspectiveCamera"](50,this.container.clientWidth/this.container.clientHeight,.01,50),this.camera.position.set(0,1,3),this.scene=new u["Scene"];var e=new h["a"](this.camera,this.container);e.target.set(0,1,0),e.update();var t=new u["PlaneGeometry"](60,60,32),n=new u["MeshStandardMaterial"]({color:4473924}),s=new u["Mesh"](t,n);s.position.set(0,0,0),s.rotation.x=-Math.PI/2,s.castShadow=!0,s.receiveShadow=!0,this.scene.add(s);var i=new u["PointLight"](16777215,3);i.position.set(0,6,0),i.castShadow=!0,i.shadow.mapSize.width=2048,i.shadow.mapSize.height=2048,i.shadow.camera.near=1,i.shadow.camera.far=1e3,this.scene.add(i);var r=new u["Color"](3355443);this.scene.fog=new u["Fog"](r,5,20),this.scene.background=r,this.meshGroup=new u["Group"],this.meshGroup.position.set(0,0,0),this.scene.add(this.meshGroup),this.pointGeometry=new u["SphereGeometry"](.005,32),this.renderer=new u["WebGLRenderer"]({antialias:!0}),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=u["PCFSoftShadowMap"],this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.container.appendChild(this.renderer.domElement)},removeFigure:function(){var e,t,n;void 0!=this.meshGroup&&(null===(e=this.linesFigRed)||void 0===e||e.RemoveAllLines(),null===(t=this.linesFigGreen)||void 0===t||t.RemoveAllLines(),null===(n=this.linesFigBlue)||void 0===n||n.RemoveAllLines())},initFigure:function(){var e=12284051;if(this.$store.state.isPublicMode)switch(this.$route.params.figureIdx){case"0":console.log("Color ",e),e=12284051;break;case"1":console.log("Color ",e),e=13935966;break;case"2":console.log("Color ",e),e=7849166;break;default:break}this.linesFigRed=new g(this.$store,e,{x:-2,y:0,z:2},"red"),this.linesFigGreen=new g(this.$store,13935966,{x:-4,y:0,z:0},"green"),this.linesFigBlue=new g(this.$store,7849166,{x:0,y:0,z:0},"blue"),console.log("Init Figures ",this.linesFigRed),this.meshGroup.add(this.linesFigRed.GetGroup(),this.linesFigGreen.GetGroup(),this.linesFigBlue.GetGroup()),this.linesFigRed.CreateLines(0),this.linesFigGreen.CreateLines(0),this.linesFigBlue.CreateLines(0)},animate:function(){if(requestAnimationFrame(this.animate),this.$store.state.isPlaying){var e=this.$store.state.slowMo,t=1/(e?25:50);if(this.delta+=this.clock.getDelta(),this.delta>t){if(this.$store.commit("SetCurrentFrame",this.$store.state.currentFrame+1),this.$store.state.currentFrame>=Object.keys(this.$store.state.currentJSONData["red"].frames).length)return this.$store.commit("SetAnimationStatus",!1),void this.$store.commit("SetCurrentFrame",0);this.removeFigure(),null!=this.linesFigRed&&null!=this.linesFigGreen&&null!=this.linesFigGreen&&(this.linesFigRed.CreateLines(this.$store.state.currentFrame),this.linesFigGreen.CreateLines(this.$store.state.currentFrame),this.linesFigBlue.CreateLines(this.$store.state.currentFrame)),this.delta=this.delta%t}this.renderer.setClearColor(17),this.renderer.render(this.scene,this.camera)}else this.renderer.render(this.scene,this.camera)},onDataChanged:function(){console.log("Update JSON Data"),this.removeFigure(),this.$store.commit("SetAnimationStatus",!1),this.initFigure()}},mounted:function(){var e=this;this.initScene(),this.animate(),this.$store.watch((function(e){return e.currentJSONData["red"]}),(function(t,n){e.onDataChanged()})),this.$store.watch((function(e){return e.currentJSONData["green"]}),(function(t,n){e.onDataChanged()})),this.$store.watch((function(e){return e.currentJSONData["blue"]}),(function(t,n){e.onDataChanged()}))}},b=v,S=(n("71ca"),n("2877")),w=Object(S["a"])(b,l,c,!1,null,null,null),y=w.exports,$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"playhead"}},[null!=this.$store.state.currentJSONData["red"]?n("div",{attrs:{id:"controlBar"}},[this.$store.state.isPlaying?e._e():n("PlayIcon",{staticClass:"icon",on:{click:function(t){return e.StartAnimation()}}}),this.$store.state.isPlaying?n("PauseIcon",{staticClass:"icon",on:{click:function(t){return e.PauseAnimation()}}}):e._e(),n("ProgressBar"),n("div",{staticClass:"minutes-control"},[n("div",{staticClass:"minutes"},[e._v(" "+e._s(this.convertFrameToTime(this.$store.state.currentFrame))+" / "+e._s(this.convertFrameToTime(Object.keys(this.$store.state.currentJSONData["red"].frames).length))+" "),this.$store.state.isPublicMode?e._e():n("span",[e._v(" ("+e._s(this.$store.state.currentFrame)+" / "+e._s(Object.keys(this.$store.state.currentJSONData["red"].frames).length)+") ")])]),this.$store.state.isPublicMode?e._e():n("span",[e._v(" Jump to ")]),this.$store.state.isPublicMode?e._e():n("input",{ref:"timeInput",attrs:{value:"",type:"text",placeholder:"mm:ss"},on:{change:e.SetTime}})])],1):e._e()])},O=[],F=(n("4d63"),n("ac1f"),n("25f0"),n("1276"),n("1e42")),C=n.n(F),M=n("4b80"),_=n.n(M),P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"progressbar",attrs:{id:"progressbar-outer"},on:{click:e.SetFrame}},[n("div",{staticClass:"progressbar-inner",style:{width:e.progressWidth+"px"}})])},k=[],x={name:"ProgressBar",components:{},computed:{currentClipLength:function(){return Object.keys(this.$store.state.currentJSONData["red"].frames).length},progressWidth:function(){var e=this.$store.state.currentFrame;return 500*e/this.currentClipLength}},methods:{SetFrame:function(e){var t=e.clientX-this.$refs.progressbar.getBoundingClientRect().left,n=Math.round(this.currentClipLength*t/500);console.log("Progress: ",n),this.$store.commit("SetCurrentFrame",n)}},mounted:function(){}},J=x,D=(n("aa09"),Object(S["a"])(J,P,k,!1,null,null,null)),N=D.exports,j={name:"App",components:{PlayIcon:C.a,PauseIcon:_.a,ProgressBar:N},data:function(){return{frameIdx:0}},methods:{alertInvalid:function(){alert("Please use a valid timestamp, e.g 13:12."),this.$refs.timeInput.value=""},alertOutOfRange:function(){alert("Timestamp is after end of sequence."),this.$refs.timeInput.value=""},SetTime:function(){var e=this.$refs.timeInput.value,t=new RegExp("[0-9][0-9]*:([0-9][0-9]){1}");if(t.test(e)){var n=e.split(":"),s=parseInt(n[0]),i=parseInt(n[1]);if(s<0||i<0||i>59)this.alertInvalid();else{var r=60*s+i,a=r*this.$store.state.fps,o=Object.keys(this.$store.state.currentJSONData["red"].frames).length;a>o?this.alertOutOfRange():this.$store.commit("SetCurrentFrame",a)}}else this.alertInvalid()},StartAnimation:function(){this.$store.commit("SetAnimationStatus",!0)},PauseAnimation:function(){this.$store.commit("SetAnimationStatus",!1)},mapSeconds:function(e,t,n,s,i){return(e-t)*(i-s)/(n-t)+s},convertFrameToTime:function(e){var t=Math.round(e/this.$store.state.fps/60*100)/100,n=Math.floor(t),s=Math.ceil(this.mapSeconds(t%1,0,.99999,0,59));return n+":"+(s<10?"0"+s:s)},convertTimeToFrame:function(e,t){return 0}},mounted:function(){}},G=j,L=(n("22db"),Object(S["a"])(G,$,O,!1,null,"4e75e9c6",null)),A=L.exports,I=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload",attrs:{id:"json-upload"}},[n("label",{class:"btn btn-primary custom-file-upload left "+this.dataKey,attrs:{for:"json-file-upload"+this.dataKey}},[n("i",{staticClass:"fa fa-cloud-upload"}),e._v("Upload JSON "+e._s(this.dataKey)+" ")]),n("input",{attrs:{type:"file",id:"json-file-upload"+this.dataKey,value:"Import"},on:{change:e.onFileChange}}),n("br"),n("div",{staticClass:"frames"},[e._v(" "+e._s(this.$store.state.filename[this.dataKey].toString())+" ")])])},R=[],T=(n("b0c0"),{name:"Upload",props:["dataKey"],components:{},methods:{onFileChange:function(e){var t=e.target.files||e.dataTransfer.files,n=new FileReader;n.onload=this.onReaderLoad,alert(t),n.readAsText(t[0]),this.$store.commit("SetCurrentFilename",{data:t[0].name,key:this.dataKey})},onReaderLoad:function(e){var t=JSON.parse(e.target.result);this.$store.commit("SetJSONData",{data:t,key:this.dataKey})}}}),B=T,E=(n("41f3"),Object(S["a"])(B,I,R,!1,null,null,null)),z=E.exports,K={name:"App",components:{DanceScene:y,ControlBar:A,Upload:z},methods:{toogleSlowMo:function(){this.$store.commit("SetSlowMo",!this.$store.state.slowMo)},loadJSON:function(e,t){var n=this;o.a.get("/deepdance_170421_"+e+"_0_15001.json").then((function(e){n.$store.commit("SetJSONData",{data:e.data,key:t})}))}},mounted:function(){if(this.$store.state.isPublicMode)switch(console.log(this.$route.params),this.$route.params.figureIdx){case"0":this.loadJSON("red","red");break;case"1":this.loadJSON("blue","red");break;case"2":this.loadJSON("green","red");break;case"3":this.loadJSON("red","red"),this.loadJSON("blue","blue"),this.loadJSON("green","green");break;default:this.loadJSON("red","red");break}}},U=K,W=(n("034f"),Object(S["a"])(U,i,r,!1,null,null,null)),V=W.exports,H=n("2f62");s["default"].use(H["a"]);var X=new H["a"].Store({state:{currentJSONData:{red:null,blue:null,green:null},currentFrame:0,isPlaying:!1,filename:{red:"",blue:"",green:""},dmxActive:!1,addMinVal:!0,slowMo:!0,fps:25,isPublicMode:!0},mutations:{SetJSONData:function(e,t){console.log("SET DATA FOR ",t.key),e.currentJSONData[t.key]=t.data},SetAnimationStatus:function(e,t){e.isPlaying=t},SetCurrentFrame:function(e,t){e.currentFrame=t},SetCurrentFilename:function(e,t){e.filename[t.key]=t.data},SetDMXActive:function(e,t){e.dmxActive=t},SetSlowMo:function(e,t){e.slowMo=t}}}),q=n("8c4f"),Y=n("5f5b"),Q=n("b1e0");n("f9e3"),n("2dd8");s["default"].use(Y["a"]),s["default"].use(Q["a"]),s["default"].use(q["a"]),s["default"].config.productionTip=!1;var Z=new q["a"]({routes:[{path:"/",component:V},{path:"/:figureIdx",component:V}]});new s["default"]({store:X,router:Z,render:function(e){return e(V)}}).$mount("#app")},6319:function(e,t,n){},"71ca":function(e,t,n){"use strict";n("6319")},"85ec":function(e,t,n){},9561:function(e,t,n){},aa09:function(e,t,n){"use strict";n("b2b6")},b2b6:function(e,t,n){},f884:function(e,t,n){}});
//# sourceMappingURL=app.9a779c4e.js.map